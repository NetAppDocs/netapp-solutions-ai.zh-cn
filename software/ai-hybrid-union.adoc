---
sidebar: sidebar 
permalink: software/ai-hybrid-union.html 
keywords: NetApp AI, AI, Artificial Intelligence, ML, Machine Learning, Union.ai, Hybrid AI training 
summary: ä½¿ç”¨ Union.ai ç¼–æ’å’ŒNetApp FlexCacheéƒ¨ç½²æ··åˆ AI è®­ç»ƒç¯å¢ƒï¼Œä½¿åŸºäºäº‘çš„ GPU è®­ç»ƒå·¥ä½œè´Ÿè½½èƒ½å¤Ÿé«˜æ•ˆã€å®‰å…¨åœ°è®¿é—®æœ¬åœ°æ•°æ®ã€‚ 
---
= ä½¿ç”¨ Union.ai å’ŒNetApp FlexCacheéƒ¨ç½²æ··åˆ AI è®­ç»ƒ
:allow-uri-read: 


[role="lead"]
äº†è§£å¦‚ä½•ä½¿ç”¨ Union.ai ç¼–æ’ã€ NetApp FlexCacheå’ŒTridentè¿›è¡Œ Kubernetes å­˜å‚¨é…ç½®ï¼Œä»è€Œéƒ¨ç½²æ··åˆ AI è®­ç»ƒç¯å¢ƒã€‚

David Espejoï¼ŒUnion.ai Sathish Thyagarajanï¼Œ NetApp



== æ¦‚è¿°

Union.ai çš„æ··åˆç¼–æ’å¹³å°ä¸NetApp ONTAPå’ŒFlexCacheæ— ç¼é›†æˆï¼Œå¯åŠ é€Ÿ AI/ML è®­ç»ƒå·¥ä½œæµç¨‹ã€‚è¯¥è§£å†³æ–¹æ¡ˆå…è®¸æ•°æ®å®‰å…¨åœ°ä¿ç•™åœ¨æœ¬åœ°ï¼ŒåŒæ—¶åˆ©ç”¨åŸºäºäº‘çš„ GPU è®¡ç®—è¿›è¡Œ AI è®­ç»ƒå·¥ä½œè´Ÿè½½ã€‚  NetApp FlexCacheç¡®ä¿ä»…å°†å¿…è¦çš„æ•°æ®ç¼“å­˜åœ¨äº‘ç«¯ï¼Œä»è€Œå®ç°é«˜æ•ˆã€å®‰å…¨ä¸”å¯æ‰©å±•çš„æ··åˆ AI/ML ç®¡é“ã€‚



== å®¢æˆ·ç”¨ä¾‹ï¼šæ··åˆäº‘äººå·¥æ™ºèƒ½åŸ¹è®­

* æœ¬åœ°æ•°æ®ï¼šå­˜å‚¨åœ¨NetApp ONTAPä¸Šï¼Œä»¥ç¡®ä¿åˆè§„æ€§å’Œå®‰å…¨æ€§ã€‚
* äº‘è®¡ç®—ï¼šåœ¨ EKS/GKE/AKS ä¸Šè¿›è¡Œå¯æ‰©å±•çš„ GPU è®­ç»ƒã€‚
* AI/ML ç¼–æ’ï¼šUnion.ai åè°ƒè·¨ç¯å¢ƒçš„æ•°æ®å¤„ç†å’Œè®­ç»ƒã€‚
* å­˜å‚¨é…ç½®ï¼š NetApp Tridentå¯è‡ªåŠ¨é…ç½® PVC/PVã€‚




== å®¢æˆ·ä»·å€¼

* åˆ©ç”¨NetApp ONTAP çš„æ¨ªå‘æ‰©å±•åŠŸèƒ½ï¼Œåœ¨æµ·é‡æ•°æ®é›†ä¸Šè¿è¡Œ AI å·¥ä½œè´Ÿè½½ã€‚
* ä½¿ç”¨ NetApp çš„æ··åˆäº‘åŠŸèƒ½ï¼Œåœ¨æœ¬åœ°å’Œäº‘ç«¯ä¹‹é—´ç§»åŠ¨å’ŒåŒæ­¥æ•°æ®ã€‚
* ä½¿ç”¨FlexCacheå¿«é€Ÿå°†æœ¬åœ°æ•°æ®ç¼“å­˜åˆ°äº‘ç«¯ã€‚
* Union.ai é€šè¿‡ç‰ˆæœ¬æ§åˆ¶ã€è¡€ç¼˜è·Ÿè¸ªå’Œå·¥ä»¶ç®¡ç†ç®€åŒ–äº†è·¨ç¯å¢ƒçš„ç¼–æ’ã€‚
* åœ¨äº‘ç«¯æ‰§è¡ŒåŸ¹è®­ï¼ŒåŒæ—¶å°†æ•æ„Ÿæ•°æ®ä¿ç•™åœ¨æœ¬åœ°ã€‚




== å¯ç”¨æ’ä»¶ - å‰ææ¡ä»¶

[cols="32%,68%"]
|===


| *è¦æ±‚* | *ç»†èŠ‚* 


| ONTAP ç‰ˆæœ¬ | ONTAP 9.7+ï¼ˆæ— éœ€FlexCacheè®¸å¯è¯ï¼‰ 


| FlexCacheè®¸å¯è¯ | ONTAP 9.6 åŠæ›´æ—©ç‰ˆæœ¬éœ€è¦æ­¤åŠŸèƒ½ 


| Kubernetes | æœ¬åœ°é›†ç¾¤å’Œäº‘é›†ç¾¤ï¼ˆEKS/GKE/AKSï¼‰ 


| Trident | å¯å®‰è£…åœ¨æœ¬åœ°é›†ç¾¤å’Œäº‘é›†ç¾¤ä¸Š 


| Union.ai | æ§åˆ¶å¹³é¢å·²éƒ¨ç½²ï¼ˆè”åˆäº‘æˆ–è‡ªæ‰˜ç®¡ï¼‰ 


| ç½‘ç»œè¿æ¥ | é›†ç¾¤é—´è¿é€šæ€§ï¼ˆå¦‚æœONTAPé›†ç¾¤æ˜¯ç‹¬ç«‹çš„ï¼‰ 


| æƒé™  a| 
ONTAPå’Œ Kubernetes é›†ç¾¤çš„ç®¡ç†å‘˜æƒé™ã€‚

âœ…è¯·ä½¿ç”¨æ­£ç¡®çš„ONTAPå‡­æ®ï¼ˆä¾‹å¦‚ï¼Œvsadminï¼‰ã€‚



| åˆšæ¥è§¦ Union.aiï¼Ÿ | è¯·å‚é˜…æœ¬æ–‡æ¡£æœ«å°¾çš„é…å¥—æŒ‡å—ã€‚ 
|===


== å‚è€ƒæ¶æ„

ä¸‹å›¾å±•ç¤ºäº† Union.ai æ§åˆ¶å¹³é¢ä¸NetAppå­˜å‚¨çš„é›†æˆï¼Œç”¨äºæ··åˆ AI è®­ç»ƒã€‚

image::ai-hybrid-union-001.png[é‡‡ç”¨ Union.ai å’ŒNetApp çš„æ··åˆ AI è®­ç»ƒæ¶æ„]

* Union.ai æ§åˆ¶å¹³é¢ï¼šåè°ƒå·¥ä½œæµã€ç®¡ç†æ•°æ®ç§»åŠ¨å¹¶ä¸NetApp API é›†æˆã€‚
* NetApp ONTAP + FlexCacheï¼šæä¾›ä»æœ¬åœ°åˆ°äº‘ç«¯çš„é«˜æ•ˆæ•°æ®ç¼“å­˜ã€‚
* æ··åˆè®­ç»ƒé›†ç¾¤ï¼šè®­ç»ƒä½œä¸šåœ¨äº‘ K8s é›†ç¾¤ï¼ˆä¾‹å¦‚ EKSï¼‰ä¸­è¿è¡Œï¼Œæ•°æ®ä»æœ¬åœ°ç¼“å­˜ã€‚




=== æ­¥éª¤ 1ï¼šåˆ›å»ºFlexCacheå·

ä½¿ç”¨ONTAPç³»ç»Ÿç®¡ç†å™¨

. å¯¼èˆªè‡³â€œå­˜å‚¨â€>â€œå·â€ã€‚
. å•å‡»â€œæ·»åŠ â€ã€‚
. é€‰æ‹©æ›´å¤šé€‰é¡¹ã€‚
. å¯ç”¨â€œæ·»åŠ ä¸ºè¿œç¨‹å·çš„ç¼“å­˜â€åŠŸèƒ½ã€‚
. é€‰æ‹©æºå·ï¼ˆæœ¬åœ°ï¼‰å’Œç›®æ ‡å·ï¼ˆäº‘ï¼‰ã€‚
. å®šä¹‰æœåŠ¡è´¨é‡æˆ–æ€§èƒ½çº§åˆ«ï¼ˆå¯é€‰ï¼‰ã€‚
. å•å‡»â€œåˆ›å»ºâ€ã€‚


ğŸ’¡å¦‚æœç”±äºæƒé™æˆ–èšåˆé—®é¢˜å¯¼è‡´NetApp DataOps Toolkit æ— æ³•æ­£å¸¸å·¥ä½œï¼Œè¯·ç›´æ¥ä½¿ç”¨ONTAPç³»ç»Ÿç®¡ç†å™¨æˆ– CLI åˆ›å»ºFlexCacheå·ã€‚



=== æ­¥éª¤ 2ï¼šé…ç½® Trident

åœ¨ä¸¤ä¸ªé›†ç¾¤ä¸Šéƒ½å®‰è£…Trident ï¼š

ğŸ”— https://docs.netapp.com/us-en/trident/trident-get-started/kubernetes-deploy.html["+++ Tridentå®‰è£…æŒ‡å—+++"]

åˆ›å»ºTridentåç«¯

[source, cli]
----
apiVersion: trident.netapp.io/v1
kind: TridentBackendConfig
metadata:
name: ontap-flexcache
spec:
version: 1
storageDriverName: ontap-nas
managementLIF: <ONTAP-MGMT-IP>
dataLIF: <ONTAP-DATA-IP>
svm: <SVM-NAME>
username: vsadmin
password: <password>

Apply: kubectl apply -f backend-flexcache.yaml
----
å¦‚æœæ”¶åˆ° 401 æœªæˆæƒé”™è¯¯ï¼Œè¯·éªŒè¯ONTAPç”¨æˆ·æ˜¯å¦å…·æœ‰è¶³å¤Ÿçš„ API æƒé™ï¼Œä»¥åŠæ˜¯å¦ä½¿ç”¨äº†æ­£ç¡®çš„ç”¨æˆ·å (vsadmin) å’Œå¯†ç ã€‚

å®šä¹‰å­˜å‚¨ç±»

[source, cli]
----
apiVersion: storage.k8s.io/v1
kind: StorageClass
metadata:
name: flexcache-sc
provisioner: csi.trident.netapp.io
parameters:
backendType: "ontap-nas"
Apply:
kubectl apply -f storageclass-flexcache.yaml
----


=== æ­¥éª¤ 3ï¼šéƒ¨ç½² Union.ai å·¥ä½œæµ

Union ä½¿ç”¨ PVC å°†FlexCacheå·æŒ‚è½½åˆ°è®­ç»ƒä½œä¸šä¸­ã€‚

ç¤ºä¾‹ PodTemplate

[source, cli]
----
apiVersion: v1
kind: PodTemplate
metadata:
name: netapp-podtemplate
namespace: flytesnacks-development
template:
metadata:
labels:
default-storage: netapp
spec:
containers:
- name: primary
volumeMounts:
- name: flexcache-storage
mountPath: /data/flexcache
volumes:
- name: flexcache-storage
persistentVolumeClaim:
claimName: flexcache-pvc
----
ç¤ºä¾‹å·¥ä½œæµç¨‹

ä»è”åˆå¯¼å…¥ä»»åŠ¡ã€å·¥ä½œæµ

[source, cli]
----
@task(pod_template="netapp-podtemplate")

def train_model(pvc_path: str):
----


= åŠ è½½å¹¶ä½¿ç”¨æ¥è‡ª PVC çš„æ•°æ®è¿›è¡Œè®­ç»ƒã€‚

[source, cli]
----
@workflow

def training_pipeline():

train_model(pvc_path="/data/flexcache")
----
å·¥ä¼šè¿è¥å•†å°†ï¼š

* åˆ¶ä½œPVCç®¡
* æŒ‚è½½FlexCacheå·
* åœ¨äº‘ç«¯ Kubernetes é›†ç¾¤ä¸­è°ƒåº¦ä½œä¸š




=== æ­¥éª¤ 4ï¼šéªŒè¯é›†æˆ

[cols="21%,79%"]
|===
| *ä»»åŠ¡* | *éªŒè¯* 


| PVCæ”¯æ¶ | è®­ç»ƒ pod åº”è¯¥èƒ½å¤ŸæˆåŠŸæŒ‚è½½ /data/flexcacheã€‚ 


| æ•°æ®è®¿é—® | è®­ç»ƒä½œä¸šå¯ä»¥å¯¹FlexCacheè¿›è¡Œè¯»å†™æ“ä½œã€‚ 


| ç¼“å­˜è¡Œä¸º | ç›‘æ§ONTAPä¸­çš„ç¼“å­˜å‘½ä¸­/æœªå‘½ä¸­æƒ…å†µã€‚ç¡®ä¿èšåˆæ”¯æŒFlexCache 


| æ€§èƒ½ | éªŒè¯è®­ç»ƒå·¥ä½œè´Ÿè½½çš„å»¶è¿Ÿå’Œååé‡ 
|===
ä½¿ç”¨NetApp BlueXPæˆ–ONTAP CLI ç›‘æ§æ€§èƒ½ã€‚



== å®‰å…¨æ³¨æ„äº‹é¡¹

* ä½¿ç”¨ VPC ç«¯ç‚¹ä¸ºNetApp ONTAP çš„FSx å¯ç”¨
* å¯ç”¨ä¼ è¾“ä¸­å’Œé™æ€åŠ å¯†
* ç”³è¯·åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶/èº«ä»½ä¸æˆæƒä»¥è®¿é—®ONTAP
* Union.ai ä¸ä¼šè®¿é—®æˆ–å­˜å‚¨å®¢æˆ·æ•°æ®




== ç›‘æµ‹ä¸ä¼˜åŒ–

[cols="31%,69%"]
|===


| *å·¥å…·* | *ç›®çš„* 


| NetApp BlueXP | ç›‘æ§FlexCache çš„ä½¿ç”¨æƒ…å†µå’Œæ€§èƒ½ 


| Union.ai ç”¨æˆ·ç•Œé¢ | è·Ÿè¸ªç®¡é“çŠ¶æ€å’ŒæŒ‡æ ‡ 


| Tridentæ—¥å¿— | è°ƒè¯• PVC æˆ–åç«¯é—®é¢˜ 
|===
*å¯é€‰å¢å¼ºåŠŸèƒ½*

* ä½¿ç”¨BlueXP API è‡ªåŠ¨åˆ›å»ºFlexCache
* ä½¿ç”¨ Union SDK åœ¨è®­ç»ƒå‰é¢„çƒ­ç¼“å­˜
* è®­ç»ƒåæ·»åŠ æ‰¹é‡æ¨ç†æˆ–æ¨¡å‹æœåŠ¡ç®¡é“
* å¦‚æœ DataOps Toolkit å¤±è´¥ï¼Œåˆ™å›é€€åˆ°é€šè¿‡ç³»ç»Ÿç®¡ç†å™¨æ‰‹åŠ¨åˆ›å»ºFlexCache ã€‚


æ•…éšœæ’é™¤

[cols="41%,59%"]
|===
| _é—®é¢˜_ | _è§£å†³_ 


| PVCå¡åœ¨å¾…å®šçŠ¶æ€ | æ£€æŸ¥Tridentæ—¥å¿—å’Œåç«¯é…ç½® 


| æ¥è‡ªONTAP API çš„ 401 æœªæˆæƒ | ä½¿ç”¨ vsadmin å¹¶éªŒè¯æƒé™ 


| ä½œä¸šå¤±è´¥ï¼šæ²¡æœ‰åˆé€‚çš„å­˜å‚¨ç©ºé—´ | ç¡®ä¿ONTAPèšåˆæ”¯æŒFlexCache/ FabricPool 


| è®­ç»ƒè¡¨ç°ç¼“æ…¢ | æ£€æŸ¥ç¼“å­˜å‘½ä¸­ç‡å’Œç½‘ç»œå»¶è¿Ÿ 


| æ•°æ®æœªåŒæ­¥ | åœ¨ONTAPä¸­éªŒè¯FlexCacheå…³ç³»å¥åº·çŠ¶å†µ 
|===
*åç»­æ­¥éª¤*

. ä½¿ç”¨æµ‹è¯•æ•°æ®éªŒè¯FlexCache
. éƒ¨ç½² Union.ai è®­ç»ƒç®¡é“
. ç›‘æ§å’Œä¼˜åŒ–æ€§èƒ½
. è®°å½•å®¢æˆ·ç‰¹å®šè®¾ç½®




== ç›¸å…³é“¾æ¥

* https://docs.union.ai["+++Union.ai æ–‡æ¡£+++"]
* https://docs.netapp.com/us-en/ontap/flexcache/index.html["+++ NetApp FlexCacheæ¦‚è¿°+++"]
* https://docs.netapp.com/us-en/trident/index.html["+++ Trident CSI é©±åŠ¨ç¨‹åº+++"]
* https://docs.aws.amazon.com/fsx/latest/ONTAPGuide/what-is-fsx-ontap.html["+++é€‚ç”¨äºNetApp ONTAP çš„ FSx+++"]




== ç»“æŸè¯­

æ‚¨ç°åœ¨æ‹¥æœ‰ä¸€ä¸ªç»è¿‡éªŒè¯çš„æ··åˆ AI è®­ç»ƒç¯å¢ƒï¼Œè¯¥ç¯å¢ƒä½¿ç”¨ Union.ai å’ŒNetApp FlexCacheã€‚è®­ç»ƒä½œä¸šå¯ä»¥åœ¨äº‘ç«¯è¿è¡Œï¼ŒåŒæ—¶å®‰å…¨é«˜æ•ˆåœ°è®¿é—®æœ¬åœ°æ•°æ®ï¼Œè€Œæ— éœ€å¤åˆ¶æ•´ä¸ªæ•°æ®é›†æˆ–æŸå®³æ²»ç†ã€‚



=== *Union.ai - é…å¥—æŒ‡å—*



==== ç¬¬ä¸€æ­¥ï¼šé€‰æ‹©éƒ¨ç½²æ¨¡å¼

*æ–¹æ¡ˆAï¼šè”åˆäº‘*

* è®¿é—®ï¼š https://console.union.ai["+++console.union.ai+++"]
* åˆ›å»ºç»„ç»‡ â†’ åˆ›å»ºé¡¹ç›®


*é€‰é¡¹Bï¼šè‡ªæ‰˜ç®¡*

* è·Ÿéšï¼šhttps://docs.union.ai/platform/latest/deployment/self-hosted/["+++è‡ªæ‰˜ç®¡æŒ‡å—+++"]
* é€šè¿‡ Helm éƒ¨ç½²ï¼š


helm repo add unionai https://unionai.github.io/helm-charts/[]

helm install union unionai/union -n union-system -f values.yaml



==== *æ­¥éª¤ 2ï¼šå®‰è£…è”åˆè¿ç®—ç¬¦*

**î°ƒ**kubectl apply -fhttps://raw.githubusercontent.com/unionai/operator/main/deploy/operator.yaml[]

kubectl get pods -n union-system

î°‚



==== æ­¥éª¤ 3ï¼šå®‰è£… Union CLI

**î°ƒ**pip install unionai

å·¥ä¼šç™»å½•

î°‚



==== *æ­¥éª¤ 4ï¼šæ³¨å†Œå·¥ä½œæµç¨‹*

**î°ƒ**è”åˆé¡¹ç›®åˆ›å»ºæ··åˆäººå·¥æ™ºèƒ½

union register training_pipeline.py --project hybrid-ai

î°‚



==== *æ­¥éª¤ 5ï¼šè¿è¡Œå’Œç›‘æ§*

**î°ƒ**union run training_pipeline --project hybrid-ai

è”åˆè§‚å¯ŸåŸ¹è®­ç®¡é“

æŸ¥çœ‹æ—¥å¿— https://console.union.ai["+++è”åˆç”¨æˆ·ç•Œé¢+++"]



==== *æ­¥éª¤ 6ï¼šæ³¨å†Œè®¡ç®—é›†ç¾¤ï¼ˆå¯é€‰ï¼‰*

**î°ƒ**union cluster register --name cloud-k8s --kubeconfig ~/.kube/config



==== *æ­¥éª¤7ï¼šè¿½è¸ªæ–‡ç‰©åŠä¼ æ‰¿*

Union ä¼šè‡ªåŠ¨è·Ÿè¸ªï¼š

* è¾“å…¥/è¾“å‡ºå‚æ•°
* æ•°æ®ç‰ˆæœ¬
* æ—¥å¿—å’ŒæŒ‡æ ‡
* æ‰§è¡Œè°±ç³»

